{"ast":null,"code":"import _toConsumableArray from\"/Users/raphaellepaquet/lighthouse/shop-petitsfruits/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import React,{useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{Link,useParams}from\"react-router-dom\";import{listProducts}from\"../actions/productActions\";import LoadingBox from\"../components/LoadingBox\";import MessageBox from\"../components/MessageBox\";import Product from\"../components/Product\";import{prices}from\"../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function SearchScreen(props){var _useParams=useParams(),_useParams$name=_useParams.name,name=_useParams$name===void 0?\"all\":_useParams$name,_useParams$category=_useParams.category,category=_useParams$category===void 0?\"all\":_useParams$category,_useParams$min=_useParams.min,min=_useParams$min===void 0?0:_useParams$min,_useParams$max=_useParams.max,max=_useParams$max===void 0?0:_useParams$max,_useParams$order=_useParams.order,order=_useParams$order===void 0?\"newest\":_useParams$order,_useParams$pageNumber=_useParams.pageNumber,pageNumber=_useParams$pageNumber===void 0?1:_useParams$pageNumber;var dispatch=useDispatch();var productList=useSelector(function(state){return state.productList;});var loading=productList.loading,error=productList.error,products=productList.products,page=productList.page,pages=productList.pages;var productCategoryList=useSelector(function(state){return state.productCategoryList;});var loadingCategories=productCategoryList.loading,errorCategories=productCategoryList.error,categories=productCategoryList.categories;useEffect(function(){dispatch(listProducts({pageNumber:pageNumber,name:name!==\"all\"?name:\"\",category:category!==\"all\"?category:\"\",min:min,max:max,order:order}));},[category,dispatch,max,min,name,order,pageNumber]);var getFilterUrl=function getFilterUrl(filter){var filterPage=filter.page||pageNumber;var filterCategory=filter.category||category;var filterName=filter.name||name;var sortOrder=filter.order||order;var filterMin=filter.min?filter.min:filter.min===0?0:min;var filterMax=filter.max?filter.max:filter.max===0?0:max;return\"/search/category/\".concat(filterCategory,\"/name/\").concat(filterName,\"/min/\").concat(filterMin,\"/max/\").concat(filterMax,\"/order/\").concat(sortOrder,\"/pageNumber/\").concat(filterPage);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(\"div\",{className:\"padding\",children:[products.length,\" \",products.length>1?'Résultats':'Résultat']})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-option\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown search-page\",children:[/*#__PURE__*/_jsxs(Link,{to:\"#\",children:[\"Categories \",/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-caret-down\"})]}),loadingCategories?/*#__PURE__*/_jsx(LoadingBox,{}):errorCategories?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:errorCategories}):/*#__PURE__*/_jsxs(\"ul\",{className:\"dropdown-content\",children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{className:\"all\"===category?\"active\":\"\",to:getFilterUrl({category:\"all\"}),children:\"Tout\"})}),categories.map(function(c){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{className:c===category?\"active\":\"\",to:getFilterUrl({category:c}),children:c})},c);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown search-page\",children:[/*#__PURE__*/_jsxs(Link,{to:\"#\",children:[\"Trier par Prix\",' ',/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-caret-down\"})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"dropdown-content\",children:prices.map(function(p){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:getFilterUrl({min:p.min,max:p.max}),className:\"\".concat(p.min,\"-\").concat(p.max)===\"\".concat(min,\"-\").concat(max)?\"active\":\"\",children:p.name})},p.name);})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-2\",children:loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(_Fragment,{children:[products.length===0&&/*#__PURE__*/_jsx(MessageBox,{children:\"No Product Found\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"category\",children:category}),/*#__PURE__*/_jsx(\"div\",{className:\"row center margin-side-lrg\",children:products.map(function(product){return/*#__PURE__*/_jsx(Product,{product:product},product._id);})}),/*#__PURE__*/_jsx(\"div\",{className:\"row center pagination\",children:_toConsumableArray(Array(pages).keys()).map(function(x){return pages.length>1?/*#__PURE__*/_jsx(Link,{className:x+1===page?\"active\":\"\",to:getFilterUrl({page:x+1}),children:x+1},x+1):'';})})]})})]});}","map":{"version":3,"sources":["/Users/raphaellepaquet/lighthouse/shop-petitsfruits/frontend/src/screens/SearchScreen.jsx"],"names":["React","useEffect","useDispatch","useSelector","Link","useParams","listProducts","LoadingBox","MessageBox","Product","prices","SearchScreen","props","name","category","min","max","order","pageNumber","dispatch","productList","state","loading","error","products","page","pages","productCategoryList","loadingCategories","errorCategories","categories","getFilterUrl","filter","filterPage","filterCategory","filterName","sortOrder","filterMin","filterMax","length","map","c","p","product","_id","Array","keys","x"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Link, useParams } from \"react-router-dom\";\nimport { listProducts } from \"../actions/productActions\";\nimport LoadingBox from \"../components/LoadingBox\";\nimport MessageBox from \"../components/MessageBox\";\nimport Product from \"../components/Product\";\nimport { prices } from \"../utils\";\n\nexport default function SearchScreen(props) {\n  const {\n    name = \"all\",\n    category = \"all\",\n    min = 0,\n    max = 0,\n    order = \"newest\",\n    pageNumber = 1,\n  } = useParams();\n  const dispatch = useDispatch();\n  const productList = useSelector((state) => state.productList);\n  const { loading, error, products, page, pages } = productList;\n\n  const productCategoryList = useSelector((state) => state.productCategoryList);\n  const {\n    loading: loadingCategories,\n    error: errorCategories,\n    categories,\n  } = productCategoryList;\n  useEffect(() => {\n    dispatch(\n      listProducts({\n        pageNumber,\n        name: name !== \"all\" ? name : \"\",\n        category: category !== \"all\" ? category : \"\",\n        min,\n        max,\n        order,\n      })\n    );\n  }, [category, dispatch, max, min, name, order, pageNumber]);\n\n  const getFilterUrl = (filter) => {\n    const filterPage = filter.page || pageNumber;\n    const filterCategory = filter.category || category;\n    const filterName = filter.name || name;\n    const sortOrder = filter.order || order;\n    const filterMin = filter.min ? filter.min : filter.min === 0 ? 0 : min;\n    const filterMax = filter.max ? filter.max : filter.max === 0 ? 0 : max;\n    return `/search/category/${filterCategory}/name/${filterName}/min/${filterMin}/max/${filterMax}/order/${sortOrder}/pageNumber/${filterPage}`;\n  };\n  return (\n    <div>\n      <div className=\"row\">\n        {loading ? (\n          <LoadingBox></LoadingBox>\n        ) : error ? (\n          <MessageBox variant=\"danger\">{error}</MessageBox>\n        ) : (\n          <div className=\"padding\">{products.length} {products.length > 1 ? 'Résultats' : 'Résultat'}</div>\n        )}\n        {/* <div>\n          Classer par{\" \"}\n          <select\n            value={order}\n            onChange={(e) => {\n              props.history.push(getFilterUrl({ order: e.target.value }));\n            }}\n          >\n            <option value=\"newest\">Nouveautés</option>\n            <option value=\"lowest\">Prix: Croissant</option>\n            <option value=\"highest\">Prix: Décroissant</option>\n          </select>\n        </div> */}\n      </div>\n      <div className=\"search-option\">\n        {/* <div className=\"col-0\"> */}\n          <div className=\"dropdown search-page\">\n            <Link to=\"#\">\n                Categories <i className=\"fa fa-caret-down\"></i>\n            </Link>\n              {loadingCategories ? (\n                <LoadingBox></LoadingBox>\n              ) : errorCategories ? (\n                <MessageBox variant=\"danger\">{errorCategories}</MessageBox>\n              ) : (\n                <ul className=\"dropdown-content\">\n                  <li>\n                    <Link\n                      className={\"all\" === category ? \"active\" : \"\"}\n                      to={getFilterUrl({ category: \"all\" })}\n                    >\n                      Tout\n                    </Link>\n                  </li>\n                  {categories.map((c) => (\n                    <li key={c}>\n                      <Link\n                        className={c === category ? \"active\" : \"\"}\n                        to={getFilterUrl({ category: c })}\n                      >\n                        {c}\n                      </Link>\n                    </li>\n                  ))}\n                </ul>\n              )}\n          </div>\n          <div className=\"dropdown search-page\">\n            <Link to=\"#\">\n                Trier par Prix{' '}<i className=\"fa fa-caret-down\"></i>\n            </Link>\n            <ul className=\"dropdown-content\">\n              {prices.map((p) => (\n                <li key={p.name}>\n                  <Link\n                    to={getFilterUrl({ min: p.min, max: p.max })}\n                    className={\n                      `${p.min}-${p.max}` === `${min}-${max}` ? \"active\" : \"\"\n                    }\n                  >\n                    {p.name}\n                  </Link>\n                </li>\n              ))}\n            </ul>\n          {/* </div> */}\n\n          {/* <h3>Catégories</h3> */}\n          {/* <div>\n            {loadingCategories ? (\n              <LoadingBox></LoadingBox>\n            ) : errorCategories ? (\n              <MessageBox variant=\"danger\">{errorCategories}</MessageBox>\n            ) : (\n              <ul>\n                <li>\n                  <Link\n                    className={\"all\" === category ? \"active\" : \"\"}\n                    to={getFilterUrl({ category: \"all\" })}\n                  >\n                    Tout\n                  </Link>\n                </li>\n                {categories.map((c) => (\n                  <li key={c}>\n                    <Link\n                      className={c === category ? \"active\" : \"\"}\n                      to={getFilterUrl({ category: c })}\n                    >\n                      {c}\n                    </Link>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </div> */}\n          {/* <div>\n            <h3>Prix</h3>\n            <ul>\n              {prices.map((p) => (\n                <li key={p.name}>\n                  <Link\n                    to={getFilterUrl({ min: p.min, max: p.max })}\n                    className={\n                      `${p.min}-${p.max}` === `${min}-${max}` ? \"active\" : \"\"\n                    }\n                  >\n                    {p.name}\n                  </Link>\n                </li>\n              ))}\n            </ul>\n          </div> */}\n        </div>\n      </div>\n        <div className=\"col-2\">\n          {loading ? (\n            <LoadingBox></LoadingBox>\n          ) : error ? (\n            <MessageBox variant=\"danger\">{error}</MessageBox>\n          ) : (\n            <>\n              {products.length === 0 && (\n                <MessageBox>No Product Found</MessageBox>\n              )}\n                <h3 className=\"category\">{category}</h3>\n              <div className=\"row center margin-side-lrg\">\n                {products.map((product) => (\n                  <Product key={product._id} product={product}></Product>\n                ))}\n              </div>\n              <div className=\"row center pagination\">\n                {[...Array(pages).keys()].map((x) => (\n                  pages.length > 1 ? \n                  <Link\n                    className={x + 1 === page ? \"active\" : \"\"}\n                    key={x + 1}\n                    to={getFilterUrl({ page: x + 1 })}\n                  >\n                    {x + 1}\n                  </Link> :\n                  ''\n                ))}\n              </div>\n            </>\n          )}\n        </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}