{"ast":null,"code":"import _objectSpread from\"/Users/raphaellepaquet/lighthouse/shop-petitsfruits/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/raphaellepaquet/lighthouse/shop-petitsfruits/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Link}from'react-router-dom';import{createOrder}from'../actions/orderActions';import CheckoutSteps from'../components/CheckoutSteps';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PlaceOrderScreen(props){var cart=useSelector(function(state){return state.cart;});var _useState=useState(5),_useState2=_slicedToArray(_useState,2),customShippingPrice=_useState2[0],setCustomShippingPrice=_useState2[1];if(!cart.paymentMethod){props.history.push('/payment');}var orderCreate=useSelector(function(state){return state.orderCreate;});var loading=orderCreate.loading,success=orderCreate.success,error=orderCreate.error,order=orderCreate.order;var toPrice=function toPrice(num){return Number(num.toFixed(2));};// 5.123 => \"5.12\" => 5.12\ncart.itemsPrice=toPrice(cart.cartItems.reduce(function(a,c){return a+c.qty*c.price;},0));cart.shippingPrice=cart.itemsPrice>100?toPrice(0):toPrice(customShippingPrice);// cart.taxPrice = toPrice(0.15 * cart.itemsPrice);\ncart.totalPrice=cart.itemsPrice+cart.shippingPrice;var dispatch=useDispatch();var placeOrderHandler=function placeOrderHandler(){dispatch(createOrder(_objectSpread(_objectSpread({},cart),{},{orderItems:cart.cartItems})));};useEffect(function(){if(success){props.history.push(\"/order/\".concat(order._id));// dispatch({ type: ORDER_CREATE_RESET });\n}},[dispatch,order,props.history,success]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"row top\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-2\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Livraison\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Nom:\"}),\" \",cart.shippingAddress.fullName,\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Adresse: \"}),\" \",cart.shippingAddress.address,\",\",cart.shippingAddress.city,\", \",cart.shippingAddress.postalCode,\",\",cart.shippingAddress.country]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Paiement\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"M\\xE9thode:\"}),\" \",cart.paymentMethod]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Items command\\xE9s\"}),/*#__PURE__*/_jsx(\"ul\",{children:cart.cartItems.map(function(item){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,className:\"small\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"min-30\",children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(\"div\",{children:[item.qty,\" x \",item.price.toFixed(2),\" = \",(item.qty*item.price).toFixed(2),\"$\"]})]})},item.product);})})]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card card-body\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"R\\xE9sum\\xE9 de la Commande\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Items\"}),/*#__PURE__*/_jsxs(\"div\",{children:[cart.itemsPrice.toFixed(2),\"$\"]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Livraison\"}),/*#__PURE__*/_jsx(\"div\",{children:cart.shippingPrice===0?'gratuite':cart.shippingPrice.toFixed(2)+'$'})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Total de la Commande\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[cart.totalPrice.toFixed(2),\"$\"]})})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:placeOrderHandler,className:\"primary block\",disabled:cart.cartItems.length===0,children:\"Placer ma commande\"})}),loading&&/*#__PURE__*/_jsx(LoadingBox,{}),error&&/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error})]})})})]})]});}","map":{"version":3,"sources":["/Users/raphaellepaquet/lighthouse/shop-petitsfruits/frontend/src/screens/PlaceOrderScreen.jsx"],"names":["React","useEffect","useState","useDispatch","useSelector","Link","createOrder","CheckoutSteps","LoadingBox","MessageBox","PlaceOrderScreen","props","cart","state","customShippingPrice","setCustomShippingPrice","paymentMethod","history","push","orderCreate","loading","success","error","order","toPrice","num","Number","toFixed","itemsPrice","cartItems","reduce","a","c","qty","price","shippingPrice","totalPrice","dispatch","placeOrderHandler","orderItems","_id","shippingAddress","fullName","address","city","postalCode","country","map","item","image","name","product","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { createOrder } from '../actions/orderActions';\nimport CheckoutSteps from '../components/CheckoutSteps';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\n\nexport default function PlaceOrderScreen(props) {\n  const cart = useSelector((state) => state.cart);\n  const [customShippingPrice, setCustomShippingPrice] = useState(5); \n  if (!cart.paymentMethod) {\n    props.history.push('/payment');\n  }\n  const orderCreate = useSelector((state) => state.orderCreate);\n  const { loading, success, error, order } = orderCreate;\n  \n  const toPrice = (num) => Number(num.toFixed(2)); // 5.123 => \"5.12\" => 5.12\n  cart.itemsPrice = toPrice(\n    cart.cartItems.reduce((a, c) => a + c.qty * c.price, 0)\n  );\n  cart.shippingPrice = cart.itemsPrice > 100 ? toPrice(0) : toPrice(customShippingPrice);\n  // cart.taxPrice = toPrice(0.15 * cart.itemsPrice);\n  cart.totalPrice = cart.itemsPrice + cart.shippingPrice;\n  const dispatch = useDispatch();\n  const placeOrderHandler = () => {\n    dispatch(createOrder({ ...cart, orderItems: cart.cartItems }));\n  };\n  useEffect(() => {\n    if (success) {\n      props.history.push(`/order/${order._id}`);\n      // dispatch({ type: ORDER_CREATE_RESET });\n    }\n  }, [dispatch, order, props.history, success]);\n  return (\n    <div>\n      <CheckoutSteps step1 step2 step3 step4></CheckoutSteps>\n      <div className=\"row top\">\n        <div className=\"col-2\">\n          <ul>\n            <li>\n              <div className=\"card card-body\">\n                <h2>Livraison</h2>\n                <p>\n                  <strong>Nom:</strong> {cart.shippingAddress.fullName} <br />\n                  <strong>Adresse: </strong> {cart.shippingAddress.address},\n                  {cart.shippingAddress.city}, {cart.shippingAddress.postalCode}\n                  ,{cart.shippingAddress.country}\n                </p>\n              </div>\n            </li>\n            <li>\n              <div className=\"card card-body\">\n                <h2>Paiement</h2>\n                <p>\n                  <strong>Méthode:</strong> {cart.paymentMethod}\n                </p>\n              </div>\n            </li>\n            <li>\n              <div className=\"card card-body\">\n                <h2>Items commandés</h2>\n                <ul>\n                  {cart.cartItems.map((item) => (\n                    <li key={item.product}>\n                      <div className=\"row\">\n                        <div>\n                          <img\n                            src={item.image}\n                            alt={item.name}\n                            className=\"small\"\n                          ></img>\n                        </div>\n                        <div className=\"min-30\">\n                          <Link to={`/product/${item.product}`}>\n                            {item.name}\n                          </Link>\n                        </div>\n\n                        <div>\n                          {item.qty} x {(item.price).toFixed(2)} = {(item.qty * item.price).toFixed(2)}$\n                        </div>\n                      </div>\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            </li>\n          </ul>\n        </div>\n        <div className=\"col-1\">\n          <div className=\"card card-body\">\n            <ul>\n              <li>\n                <h2>Résumé de la Commande</h2>\n              </li>\n              <li>\n                <div className=\"row\">\n                  <div>Items</div>\n                  <div>{cart.itemsPrice.toFixed(2)}$</div>\n                </div>\n              </li>\n              <li>\n                <div className=\"row\">\n                  <div>Livraison</div>\n                  <div>{cart.shippingPrice === 0 ? 'gratuite' : cart.shippingPrice.toFixed(2)+'$'}</div>\n                </div>\n              </li>\n              {/* <li>\n                <div className=\"row\">\n                  <div>Tax</div>\n                  <div>${cart.taxPrice.toFixed(2)}</div>\n                </div>\n              </li> */}\n              <li>\n                <div className=\"row\">\n                  <div>\n                    <strong>Total de la Commande</strong>\n                  </div>\n                  <div>\n                    <strong>{cart.totalPrice.toFixed(2)}$</strong>\n                  </div>\n                </div>\n              </li>\n              <li>\n                <button\n                  type=\"button\"\n                  onClick={placeOrderHandler}\n                  className=\"primary block\"\n                  disabled={cart.cartItems.length === 0}\n                >\n                  Placer ma commande\n                </button>\n              </li>\n              {loading && <LoadingBox></LoadingBox>}\n              {error && <MessageBox variant=\"danger\">{error}</MessageBox>}\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}